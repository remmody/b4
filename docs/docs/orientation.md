---
sidebar_position: 2
title: Быстрый старт
description: Первые шаги после установки B4 — разблокировка сайта на примере Facebook
---

# Быстрый старт: Я и DPI

Вы установили B4, сервис запущен, веб-интерфейс открывается. Что дальше?

В этом руководстве мы пройдём полный цикл разблокировки сайта — от диагностики до рабочей конфигурации. В качестве примера возьмём `facebook.com`.

## Шаг 1: Убедитесь, что сайт действительно заблокирован

Откройте `https://facebook.com` в браузере. Типичные признаки блокировки:

- Бесконечная загрузка страницы
- Ошибка «Не удаётся установить соединение»
- Сброс соединения (`ERR_CONNECTION_RESET`)
- Перенаправление на страницу-заглушку провайдера

## Шаг 2: Запускаем Discovery

**Discovery** — это автоматический поиск рабочей конфигурации обхода DPI (`сеты` - так называемые наборы конфигураций). B4 последовательно тестирует различные стратегии (фрагментация, фейкинг, десинхронизация и т.д.) и пытается найти ту, которая работает для вашего провайдера.

1. Перейдите в раздел **Discovery** в боковом меню
2. Введите домен `facebook.com` в поле ввода
3. Нажмите **Start Discovery**

![start](../static/img/orientation/20251203022730.png)

### Что происходит во время подбора

B4 проходит несколько фаз:

| Фаза                   | Что тестируется                           |
| ---------------------- | ----------------------------------------- |
| **DPI Fingerprinting** | Определение типа DPI и методов блокировки |
| **Strategy Detection** | Поиск работающих семейств стратегий       |
| **Optimization**       | Подбор оптимальных параметров             |
| **Combination**        | Тестирование комбинаций стратегий         |

:::tip Когда останавливать процесс?
Как только вы видите статус **Success** и скорость в MB/s — рабочая конфигурация предварительно найдена. Можно остановить процесс и использовать её, либо дождаться завершения для поиска более подходящего, и возможно, надежного варианта.
:::

## Шаг 3: Добавляем найденную конфигурацию

После завершения (или когда найден первый рабочий вариант):

В результатах найдите строку с лучшей скоростью
Нажмите **Use This Strategy** (или **Use Current Best** если процесс ещё идёт)

Откроется диалог добавления конфигурации:

### Варианты добавления

**Создать новый сет** — добавит новый набор конфигурации в начало списка. Рекомендуется для первого сайта.

**Добавить в существующий** — если Discovery нашёл сет с похожими настройками, можно добавить домен туда. Полезно, когда несколько сайтов работают с одинаковой конфигурацией.

Выберите вариант домена:

- `facebook.com` — покроет все поддомены (`www.facebook.com`, `m.facebook.com` и т.д.)
- `edge-chat.facebook.com` — только конкретный поддомен и его поддомены

Нажмите **Create Set** или **Add to Set**

## Шаг 4: Проверяем результат

Откройте `https://facebook.com` снова. Если страница загрузилась — базовая настройка работает.

Однако Facebook (как и многие крупные сервисы) использует множество доменов и IP-адресов. Вы можете заметить, что:

- Основная страница открывается, но медиа не грузится
- Messenger не подключается
- Приложение работает нестабильно

Это нормально — мы добавили только один домен. Переходим к следующему шагу.

## Шаг 5: Подключаем Geodata

Geodata — это базы доменов и IP-адресов, сгруппированные по категориям. Вместо ручного добавления сотен доменов Facebook, можно подключить категорию `facebook` (или еще лучше `meta`) и получить полное покрытие всех доменов компании Meta.

### Проверяем наличие файлов

Перейдите в **Settings → Geodat Settings**
В секции **Current Files** проверьте статус:

- **Geosite Database** — база доменов
- **GeoIP Database** — база IP-адресов

Если файлы отсутствуют или показывают **Not Found**:

В секции **Download Files** выберите источник:

- **RUNETFREEDOM** — рекомендуется для России, содержит актуальные списки блокировок
- **Loyalsoldier** — универсальный вариант

Нажмите **Download Files**

![geodat](../static/img/orientation/20251203213324.png)

:::info Подробнее о Geodata
Полное описание источников и категорий — в разделе [Настройки Geodat](settings.md#geodat-settings-настройки-geodat)
:::

## Шаг 6: Расширяем покрытие через категории

Теперь добавим все домены и IP Meta/Facebook в наш сет.

1. Перейдите в **Settings → Sets**
2. Найдите созданный сет (например, «facebook.com» или как вы его назвали)
3. Нажмите иконку редактирования

### Добавляем GeoSite категорию

4. Откройте вкладку **Targets**
5. В секции **Bypass Domains** найдите поле **GeoSite Categories**
6. Начните вводить `facebook` — появится автодополнение
7. Выберите категорию `facebook`

Категория `facebook` включает:

- facebook.com и все поддомены
- fbcdn.net (CDN для медиа)
- messenger.com
- instagram.com (тоже Meta)
- whatsapp.com
- И десятки других связанных доменов

### Добавляем GeoIP категорию

8. Переключитесь на вкладку **Bypass IPs**
9. В секции **GeoIP Categories** добавьте `facebook`

Это покроет все IP-диапазоны, принадлежащие Meta (AS32934).

10. Нажмите **Save Changes**

## Шаг 7: Финальная проверка

Откройте Facebook заново. Теперь должно работать:

- ✅ Основной сайт
- ✅ Загрузка изображений и видео
- ✅ Messenger
- ✅ Мобильные приложения

:::tip Мониторинг в реальном времени
Откройте раздел **Domains** — вы увидите все соединения к Facebook с бейджем вашего сета. Это подтверждает, что трафик проходит через B4 с нужной конфигурацией.
:::

## Что если не работает?

### Сайт всё ещё не открывается

1. **Проверьте QUIC** — перейдите в редактор сета → вкладка **UDP** → установите **QUIC Filter: All** и **Action Mode: Drop**. Это заставит браузер использовать TCP вместо QUIC.

2. **Попробуйте другую стратегию фрагментации** — вкладка **Fragmentation** → попробуйте **TLS Record Splitting** вместо TCP.

3. **Включите десинхронизацию** — вкладка **TCP** → **Desync Mode: combo**

### Работает нестабильно

1. **Увеличьте TTL фейковых пакетов** — вкладка **Faking** → увеличьте **Fake TTL** до 10-12

2. **Добавьте задержку** — вкладка **TCP** → увеличьте **Segment 2 Delay** до 50-100ms

### Часть функций не работает

Скорее всего, не все домены покрыты. Откройте **Domains**, найдите соединения без бейджа сета и добавьте их вручную.

## Следующие шаги

Теперь вы знаете базовый процесс. Для других сайтов алгоритм тот же:

1. Discovery → найти рабочую конфигурацию
2. Добавить в сет
3. Расширить покрытие через GeoSite/GeoIP категории
4. При необходимости — тонкая настройка параметров

### Рекомендуемые категории для популярных сервисов

| Сервис    | GeoSite             | GeoIP      |
| --------- | ------------------- | ---------- |
| YouTube   | `youtube`, `google` | `google`   |
| Telegram  | `telegram`          | `telegram` |
| Discord   | `discord`           | —          |
| Twitter/X | `twitter`           | `twitter`  |
| Instagram | `facebook`          | `facebook` |

### Полезные разделы документации

- [Наборы конфигураций](sets) — детальное описание всех параметров
- [Мониторинг соединений](domains) — работа с live-трафиком
- [Почему нужны разные наборы](sets/dpi) — понимание DPI и стратегий обхода
